## Story Log

### Goal
Implement `mm sync` command (without arguments) to perform full synchronization (pull + push) in a single operation.

### Why
Users running in `auto-commit` mode need a convenient way to manually synchronize their workspace with the remote repository. Currently they must run `mm sync pull` and `mm sync push` separately. A single `mm sync` command provides a better user experience and follows the design specified in Epic section 6.3.

### User Story
**As a mm user, I want to run `mm sync` to pull and push changes in one command, so that I can quickly synchronize my workspace with the remote repository without running multiple commands.**

### Acceptance Criteria

#### 1. Happy Path - Full Sync
- [ ] **Given** git.enabled=true and workspace has a configured remote, **When** you run `mm sync`, **Then** it executes pull followed by push and displays both operations' output

#### 2. Pull-only Success
- [ ] **Given** pull succeeds but there are no local commits to push, **When** you run `mm sync`, **Then** it completes successfully with appropriate "up-to-date" message

#### 3. Error Cases - Git Not Enabled
- [ ] **Given** git.enabled=false, **When** you run `mm sync`, **Then** it displays an error that Git sync is not enabled

#### 4. Error Cases - Pull Failure
- [ ] **Given** pull fails (e.g., non-fast-forward), **When** you run `mm sync`, **Then** it stops after pull failure and does not attempt push

#### 5. Error Cases - Push Failure
- [ ] **Given** pull succeeds but push fails, **When** you run `mm sync`, **Then** it displays the push error message

#### 6. Workspace Option
- [ ] **Given** I specify `--workspace test-ws`, **When** you run `mm sync --workspace test-ws`, **Then** it syncs the specified workspace

### Out of Scope
- `mm doctor --rebuild-index` integration (mentioned in Epic 6.3 as "optional" - will be addressed in a future story if needed)
- Auto-sync mode implementation (separate story)
- Custom sync direction options (e.g., `--pull-only`, `--push-only`)

---

### Completed Work Summary

Implemented `mm sync` command that executes pull + push operations in sequence.

**Implementation:**
- Created `SyncWorkflow` (`src/domain/workflows/sync.ts`) that orchestrates `SyncPullWorkflow` and `SyncPushWorkflow`
- Added default action to `mm sync` CLI command (`src/presentation/cli/commands/sync.ts`)
- Workflow stops on pull failure (push not attempted)
- Combines output from both operations

**Test Coverage:**
- 6 unit tests covering all acceptance criteria scenarios
- All tests passing (`deno task test`)

### Acceptance Checks

**Status: Pending Product Owner Review**

Developer verification completed:
- ✅ All 6 unit tests passing (workflow logic verified with mocked dependencies)
- ✅ `mm sync --help` displays command information correctly
- ✅ Code compiles successfully after merging main branch changes

**Note:** Unit tests verify workflow orchestration logic but use mocked Git service.
End-to-end acceptance testing with actual Git repository required.

**Awaiting product owner acceptance testing before marking this user story as complete.**

### Follow-ups / Open Risks

#### Addressed
- None (straightforward implementation combining existing workflows)

#### Remaining
- `mm doctor --rebuild-index` integration mentioned in Epic 6.3 is deferred to future story
- Auto-sync mode implementation (separate epic feature)
- End-to-end acceptance testing with actual git repository pending product owner review
